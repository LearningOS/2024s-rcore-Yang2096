## 课后问答
1. * 协作式调度与抢占式调度的区别是什么？
	- 区别在于抢占式调度借助了外部时钟来触发中断，强行打断用户程序的运行，并以此调度其他程序使用 CPU，无需之前的程序像协作式调度那样主动让出 CPU
2. * 中断、异常和系统调用有何异同之处？
	- 相同：都需要中断处理程序介入
	- 不同：中断是异步发生的，异常和系统调用相对当前执行流而言是同步的
3. * RISC-V支持哪些中断/异常？
	- 时钟中断，软件中断，外部设备中断
	- 指令特权级别异常，别的不熟
4. * 如何判断进入操作系统内核的起因是由于中断还是异常？
	- 通过 `scause` 寄存器的取值
5. ** 在 RISC-V 中断机制中，PLIC 和 CLINT 各起到了什么作用？
    - 
6. ** 基于RISC-V 的操作系统支持中断嵌套？请给出进一步的解释说明。
	- 目前进入某一特权级之后，会自动屏蔽当前特权级下的中断，需要手动开启
7. ** 本章提出的任务的概念与前面提到的进程的概念之间有何区别与联系？
    - 都包含了程序运行的执行流上下文，栈。但是还没有虚拟内存相关的抽象
8. * 简单描述一下任务的地址空间中有哪些类型的数据和代码。
    - 内核栈里保存了用户应用程序的 sstatus、sscratch、sp、寄存器
9. * 任务控制块保存哪些内容？
    - TaskContext 保存了用户应用程序对应的内核栈 sp、ra、以及寄存器
10. * 任务上下文切换需要保存与恢复哪些内容？
    - 上面说的内核栈
11. * 特权级上下文和任务上下文有何异同？
    - 任务上下文只在 S 特权级下切换，不涉及特权级的变化
    - 特权级上下文需要保存切换前的特权级，并在切回去时恢复
1. * 上下文切换为什么需要用汇编语言实现？
    - 普通的函数调用会遵循一般的栈内存控制方式，无法达到保存栈相关内容的需求
2. * 有哪些可能的时机导致任务切换？
    - 任务结束、时钟中断触发、任务自行调用 yield
3. ** 在设计任务控制块时，为何采用分离的内核栈和用户栈，而不用一个栈？
    - 多 CPU 的情况下无法复用
4. *** 我们已经在 rCore 里实现了不少操作系统的基本功能：特权级、上下文切换、系统调用……为了让大家对相关代码更熟悉，我们来以另一个操作系统为例，比较一下功能的实现。看看换一段代码，你还认不认识操作系统。
    阅读 Linux 源代码，特别是 `riscv` 架构相关的代码，回答以下问题：
    1. Linux 正常运行的时候， `stvec` 指向哪个函数？是哪段代码设置的 `stvec` 的值？
    2. Linux 里进行上下文切换的函数叫什么？（对应 rCore 的 `__switch` ）
	    - [`__switch_to`](https://elixir.bootlin.com/linux/latest/C/ident/__switch_to)
    3. Linux 里，和 rCore 中的 `TrapContext` 和 `TaskContext` 这两个类型大致对应的结构体叫什么？
    4. Linux 在内核态运行的时候， `tp` 寄存器的值有什么含义？ `sscratch` 的值是什么？
    5. Linux 在用户态运行的时候， `sscratch` 的值有什么含义？
    6. Linux 在切换到内核态的时候，保存了和用户态程序相关的什么状态？
    7. Linux 在内核态的时候，被打断的用户态程序的寄存器值存在哪里？在 C 代码里如何访问？
    8. Linux 是如何根据系统调用编号找到对应的函数的？（对应 rCore 的 `syscall::syscall()` 函数的功能）
    9. Linux 用户程序调用 `ecall` 的参数是怎么传给系统调用的实现的？系统调用的返回值是怎样返回给用户态的？